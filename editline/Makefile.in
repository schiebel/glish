# $Header$
#
# Makefile for editline C libraries.

CC = @CC@
CFLAGS = @CFLAGS@
RANLIB = @RANLIB@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@

MKHIER = @top_srcdir@/config/mkhier

SHELL = /bin/sh

RM = rm -f

SRCDIR = ..
INC = -I$(SRCDIR)/include
EDITLIB = $(ISTKLIBS)/libedit.a
LOCAL_CFLAGS = -DANSI_ARROWS -DHAVE_TCGETATTR -DHIDE -DUSE_DIRENT -DSYS_UNIX

INSTALLDIR = @top_srcdir@
LIBDIR = $(INSTALLDIR)/lib/$(ARCH)

##
## prefix may be used as part of '@exec_prefix@'
##
prefix = @prefix@
PFX_INSTALLDIR = @exec_prefix@
PFX_LIBDIR = $(PFX_INSTALLDIR)/lib

OBJS = complete.o editline.o sysunix.o

TAR_FILE = editline.tar

libs: libedit.a

libedit.a: $(OBJS)
	$(RM) libedit.a
	ar cru libedit.a $(OBJS)
	$(RANLIB) libedit.a

$(LIBDIR)/libedit.a: libedit.a
	$(MKHIER) $(LIBDIR)
	$(INSTALL_DATA) libedit.a $(LIBDIR)
	$(RANLIB) $(LIBDIR)/libedit.a

install: $(LIBDIR)/libedit.a

$(PFX_LIBDIR)/libedit.a: libedit.a
	$(MKHIER) $(PFX_LIBDIR)
	$(INSTALL_DATA) libedit.a $(PFX_LIBDIR)
	$(RANLIB) $(PFX_LIBDIR)/libedit.a

prefix-install: $(PFX_LIBDIR)/libedit.a

tar:
	@rm -f $(TAR_FILE).Z tar-files
	@$(MAKE) $(MFLAGS) tar-list >tar-files
	tar cf $(TAR_FILE) -I tar-files
	compress $(TAR_FILE)
	@rm -f tar-files

tar-list:
	@echo editline >&2
	@ls README Makefile.in *.c editline.3 include/*.h

rcsinfo:
	@echo editline
	@rlog -L -S RCS/*,v

clean:
	@rm -f errs *.o *~* $(APPS) core a.out *.a ../$(TAR_FILE).Z

distclean: clean
	rm -f config.status config.cache config.h Makefile

editline.o: $(SRCDIR)/editline.c
	$(CC) $(CFLAGS) $(LOCAL_CFLAGS) $(INC) -c $(SRCDIR)/editline.c

complete.o: $(SRCDIR)/complete.c
	$(CC) $(CFLAGS) $(LOCAL_CFLAGS) $(INC) -c $(SRCDIR)/complete.c

sysunix.o: $(SRCDIR)/sysunix.c
	$(CC) $(CFLAGS) $(LOCAL_CFLAGS) $(INC) -c $(SRCDIR)/sysunix.c
